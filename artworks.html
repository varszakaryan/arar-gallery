<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="screen-orientation" content="portrait">
    <meta name="orientation" content="portrait">
    <title>All Artworks - ARAR Gallery</title>
    
    <link rel="icon" type="image/svg+xml" href="assets/images/ar.svg?v=2">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Franklin:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HGM21QWH4E"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-HGM21QWH4E');
    </script>
</head>
<body>
    <header>
        <div class="header-container">
            <div class="logo">
                <a href="/" aria-label="Go to homepage">
                    <img src="assets/images/arar.svg" alt="ARAR" class="logo-img">
                </a>
            </div>
            <button class="menu-toggle" aria-label="Toggle menu" onclick="toggleMenu()">
                <span class="material-icons-outlined">menu</span>
            </button>
            <div class="menu-overlay" onclick="toggleMenu()"></div>
            <nav id="main-nav" class="nav-menu">
                <button class="menu-close-btn" onclick="toggleMenu()" aria-label="Close menu">
                    <span class="material-icons-outlined">close</span>
                </button>
                <div class="nav-dropdown">
                    <a href="#" class="nav-dropdown-toggle" onclick="toggleDropdown(event)">Exhibitions</a>
                    <div class="nav-dropdown-menu">
                        <a href="/?exhibition=guyduk-presence-2026">PRESENCE - Anatoliy Guyduk Solo Exhibition</a>
                        <a href="/?exhibition=contemporary-art-2026">Contemporary Art Exhibition-Fundraiser</a>
                    </div>
                </div>
                <a href="/#artists">Artists</a>
                <a href="/#artworks">Artworks</a>
                <a href="/#merch">Merch</a>
                <a href="/#organizers">Organizers</a>
                <a href="/#partners">Partners</a>
                <a href="/#contacts">Contacts</a>
            </nav>
        </div>
    </header>

    <button class="scroll-up-btn" id="scrollUpBtn" onclick="scrollToTop()" aria-label="Scroll to top">
        <span class="material-icons-outlined">keyboard_arrow_up</span>
    </button>

    <main>
        <div class="artworks-section" id="artworks" style="margin-top: 0; padding-top: 80px;">
            <h3 class="artworks-title">All Artworks</h3>
            <div class="artworks-content">
                <div class="artworks-controls">
                    <div class="sort-container">
                        <button class="sort-btn" id="sortBtn" onclick="toggleSortMenu(event)">
                            <span class="sort-label">Sort by price</span>
                            <span class="material-icons-outlined">arrow_drop_down</span>
                        </button>
                        <div class="sort-menu" id="sortMenu">
                            <button class="sort-option" onclick="sortArtworks('high-to-low')">Highest to Lowest</button>
                            <button class="sort-option" onclick="sortArtworks('low-to-high')">Lowest to Highest</button>
                        </div>
                    </div>
                </div>
                <div class="merch-grid" id="artworksGrid">
                    <p class="merch-loading">Loading...</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        function toggleMenu() {
            const nav = document.getElementById('main-nav');
            const menuToggle = document.querySelector('.menu-toggle');
            const overlay = document.querySelector('.menu-overlay');
            nav.classList.toggle('nav-open');
            menuToggle.classList.toggle('menu-open');
            if (overlay) {
                overlay.classList.toggle('active');
            }
        }

        let dropdownTimeout = null;

        function toggleDropdown(event) {
            event.preventDefault();
            event.stopPropagation();
            const dropdown = event.currentTarget.closest('.nav-dropdown');
            if (dropdown) {
                dropdown.classList.toggle('active');
                // Clear any pending timeout when manually toggling
                if (dropdownTimeout) {
                    clearTimeout(dropdownTimeout);
                    dropdownTimeout = null;
                }
            }
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Show/hide scroll-up button based on scroll position
        window.addEventListener('scroll', function() {
            const scrollUpBtn = document.getElementById('scrollUpBtn');
            if (scrollUpBtn) {
                if (window.scrollY > 300) {
                    scrollUpBtn.classList.add('show');
                } else {
                    scrollUpBtn.classList.remove('show');
                }
            }
        });

        // Close menu when clicking on a link
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize dropdown functionality
            const dropdowns = document.querySelectorAll('.nav-dropdown');
            dropdowns.forEach(dropdown => {
                const dropdownMenu = dropdown.querySelector('.nav-dropdown-menu');
                
                function clearDropdownTimeout() {
                    if (dropdownTimeout) {
                        clearTimeout(dropdownTimeout);
                        dropdownTimeout = null;
                    }
                }

                function hideDropdown() {
                    dropdownTimeout = setTimeout(function() {
                        dropdown.classList.remove('active');
                        dropdownTimeout = null;
                    }, 2000); // Keep visible for 2 seconds after mouse leaves
                }

                // When mouse enters dropdown toggle or menu, show it and clear any timeout
                dropdown.addEventListener('mouseenter', function() {
                    clearDropdownTimeout();
                    dropdown.classList.add('active');
                });

                // When mouse leaves dropdown, start timer to hide
                dropdown.addEventListener('mouseleave', function(e) {
                    // Check if mouse is moving to the menu
                    const relatedTarget = e.relatedTarget;
                    if (!dropdown.contains(relatedTarget)) {
                        hideDropdown();
                    }
                });

                if (dropdownMenu) {
                    // When mouse enters the menu, clear timeout
                    dropdownMenu.addEventListener('mouseenter', function() {
                        clearDropdownTimeout();
                    });

                    // When mouse leaves the menu, start timer
                    dropdownMenu.addEventListener('mouseleave', function() {
                        hideDropdown();
                    });
                }
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.nav-dropdown')) {
                    dropdowns.forEach(dropdown => {
                        dropdown.classList.remove('active');
                        if (dropdownTimeout) {
                            clearTimeout(dropdownTimeout);
                            dropdownTimeout = null;
                        }
                    });
                }
            });
            const navLinks = document.querySelectorAll('#main-nav a');
            navLinks.forEach(link => {
                link.addEventListener('click', function() {
                    const nav = document.getElementById('main-nav');
                    const menuToggle = document.querySelector('.menu-toggle');
                    const overlay = document.querySelector('.menu-overlay');
                    nav.classList.remove('nav-open');
                    menuToggle.classList.remove('menu-open');
                    if (overlay) {
                        overlay.classList.remove('active');
                    }
                });
            });

            // Load and display all artworks
            loadAllArtworks();
        });

        // Function to flip artwork image
        function flipMerchImage(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            container.classList.toggle('flipped');
        }

        // Helper function to get artist profile image path
        function getArtistProfileImage(artistName) {
            const artistImageMap = {
                'Raydan Zebian (Spazuno)': 'assets/images/artists/spaz_profile.jpg',
                'Spazuno': 'assets/images/artists/spaz_profile.jpg',
                'Karen Akhikyan': 'assets/images/artists/karen_akhikyan_profile.jpg',
                'Aram Poladian': 'assets/images/artists/aram_poladian_profile.png',
                'Guy Ghazanchyan': 'assets/images/artists/guy_ghazanchyan_profile.webp',
                'Hayduk Smbatyan': 'assets/images/artists/hayduk_smbatyan_profile.jpeg',
                'Adam Adamyan': 'assets/images/artists/adam_adamyan_profile.webp',
                'Aram Yengibaryan': 'assets/images/artists/aram_yengibaryan_profile.jpg',
                'Armen Hakobjanyan': 'assets/images/artists/armen_hakobjanyan_profile.jpg',
                'Lilith Leel Eghiazaryan': 'assets/images/artists/lilit_eghiazaryan_profile.jpg',
                'Lilit Eghiazaryan': 'assets/images/artists/lilit_eghiazaryan_profile.jpg',
                'Siranush Vardanyan': 'assets/images/artists/siranush_vardanyan_profile.jpg',
                'Lubna Al-Lahham': 'assets/images/artists/lubna_al_lahham_profile.png',
                'Tigran Ghazaryan': 'assets/images/artists/tigran_ghazaryan_profile.avif',
                'Ashot Harutyunyan': 'assets/images/artists/ashot_harutyunyan_profile.jpg',
                'Tina Karakeshishyan': 'assets/images/artists/tina_karakeshishyan_profile.png',
                'Anatoliy Guyduk': 'assets/images/artists/anatoliy_guyduk_profile.jpeg',
                'Aksel Zardaryan': 'assets/images/artists/aksel_zardaryan_profile.png',
                'Aksel Zardaryan-Mavian': 'assets/images/artists/aksel_zardaryan_profile.png'
            };
            
            return artistImageMap[artistName] || 'assets/images/arar.svg';
        }

        // Store artworks data globally for sorting
        let allArtworksData = [];
        let currentSortOrder = null;

        // Load and display all artworks
        function loadAllArtworks() {
            const artworksGrid = document.getElementById('artworksGrid');
            if (!artworksGrid) {
                console.error('Artworks grid element not found');
                return;
            }

            // Load from artworks.json file
            fetch('artworks.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to fetch artworks.json');
                    }
                    return response.json();
                })
                .then(data => {
                    if (data && data.length > 0) {
                        // Filter out artworks without images
                        const artworksWithImages = data.filter(artwork => {
                            const images = artwork.images || (artwork.image ? [artwork.image] : []);
                            return images.length > 0 && images.some(img => img && img.trim() !== '');
                        });
                        
                        // Store all artworks data
                        allArtworksData = artworksWithImages;
                        
                        // Apply current sort if active
                        let displayedArtworks = artworksWithImages;
                        if (currentSortOrder) {
                            displayedArtworks = sortArtworksData(displayedArtworks, currentSortOrder);
                        }
                        
                        renderArtworks(displayedArtworks);
                        console.log('All artworks loaded from artworks.json');
                    } else {
                        artworksGrid.innerHTML = '<p class="merch-empty">Coming soon</p>';
                    }
                })
                .catch(err => {
                    console.error('Failed to load artworks.json:', err);
                    artworksGrid.innerHTML = '<p class="artworks-empty">Error loading artworks. Please check console for details.</p>';
                });
        }

        // Render artworks to the grid
        function renderArtworks(artworks) {
            const artworksGrid = document.getElementById('artworksGrid');
            if (!artworksGrid) return;
            
            artworksGrid.innerHTML = artworks.map((artwork, index) => {
                            const artworkId = `artwork-${index}`;
                            // Support both images array and single image
                            const images = artwork.images || (artwork.image ? [artwork.image] : []);
                            const fallbackImage = getArtistProfileImage(artwork.artist);
                            const firstImage = images[0];
                            const secondImage = images.length > 1 && images[1] ? images[1] : firstImage;
                            
                            return `
                            <div class="merch-item">
                                <div class="merch-image-container" onclick="${images.length > 1 ? `event.preventDefault(); flipMerchImage('${artworkId}')` : ''}" style="cursor: ${images.length > 1 ? 'pointer' : 'default'}">
                                    <div class="merch-flip-container" id="${artworkId}">
                                        <div class="merch-flip-front">
                                            <img src="${firstImage}" alt="${artwork.title}" class="merch-image" onerror="this.onerror=null; this.src='${fallbackImage}'">
                                        </div>
                                        <div class="merch-flip-back">
                                            <img src="${secondImage}" alt="${artwork.title}" class="merch-image" onerror="this.onerror=null; this.src='${fallbackImage}'">
                                        </div>
                                    </div>
                                    ${images.length > 1 ? `
                                    <button class="merch-flip-btn" onclick="event.preventDefault(); event.stopPropagation(); flipMerchImage('${artworkId}')" title="Flip image">
                                        <span class="material-icons-outlined">sync</span>
                                    </button>
                                    ` : ''}
                                </div>
                                <div class="merch-info">
                                    <div class="merch-info-left">
                                        <p class="merch-item-title"><a href="${artwork.artistLink}?from=artworks" class="artist-name-link">${artwork.artist} <span class="merch-separator">·</span> ${artwork.country}</a></p>
                                        <p class="merch-artist">
                                            ${artwork.title || ''}
                                            ${artwork.year ? ` <span class="merch-separator">·</span> ${artwork.year}` : ''}
                                        </p>
                                        <p class="merch-details-combined">
                                            <span class="merch-medium">${artwork.media}</span>
                                        </p>
                                        <p class="merch-dimensions">${artwork.size || 'size not available'}</p>
                                        <p class="merch-price">
                                            ${artwork.status === 'Sold out' ? 
                                                (artwork.originalPrice ? (artwork.originalPriceAMD ? '<span class="merch-price-original-no-strike">֏' + artwork.originalPriceAMD + '</span> ' : '') + '<span class="merch-price-original-no-strike">($' + artwork.originalPrice + ')</span> ' : '') +
                                                '<span class="merch-price-discounted">Sold out</span>' : 
                                                artwork.status === 'Gift' ? 
                                                    (artwork.originalPrice ? (artwork.originalPriceAMD ? '<span class="merch-price-original-no-strike">֏' + artwork.originalPriceAMD + '</span> ' : '') + '<span class="merch-price-original-no-strike">($' + artwork.originalPrice + ')</span> ' : '') +
                                                    '<span class="merch-price-discounted">Gifted</span>' :
                                                (artwork.originalPrice ? (artwork.originalPriceAMD ? '<span class="merch-price-original">֏' + artwork.originalPriceAMD + '</span> ' : '') + '<span class="merch-price-original">($' + artwork.originalPrice + ')</span> ' : '') +
                                                (artwork.priceAMD ? '<span class="merch-price-discounted">֏' + artwork.priceAMD + '</span> ' : '') +
                                                '<span class="merch-price-discounted">($' + artwork.price + ')</span>'}
                                        </p>
                                    </div>
                                </div>
                            </div>
                            `;
            }).join('');
        }

        // Sort artworks data
        function sortArtworksData(artworks, order) {
            const sorted = [...artworks];
            sorted.sort((a, b) => {
                const priceA = parseFloat(a.price) || 0;
                const priceB = parseFloat(b.price) || 0;
                return order === 'high-to-low' ? priceB - priceA : priceA - priceB;
            });
            return sorted;
        }

        // Toggle sort menu
        function toggleSortMenu(event) {
            event.stopPropagation();
            const menu = document.getElementById('sortMenu');
            if (menu) {
                menu.classList.toggle('show');
            }
        }

        // Close sort menu when clicking outside
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('sortMenu');
            const button = document.getElementById('sortBtn');
            if (menu && button && !menu.contains(event.target) && !button.contains(event.target)) {
                menu.classList.remove('show');
            }
        });

        // Sort artworks
        function sortArtworks(order) {
            currentSortOrder = order;
            const artworksGrid = document.getElementById('artworksGrid');
            if (!artworksGrid || allArtworksData.length === 0) return;

            // Sort all artworks
            let displayedArtworks = sortArtworksData(allArtworksData, order);
            
            // Update sort button label
            const sortLabel = document.querySelector('.sort-label');
            if (sortLabel) {
                sortLabel.textContent = order === 'high-to-low' ? 'Highest to Lowest' : 'Lowest to Highest';
            }
            
            // Close menu
            const menu = document.getElementById('sortMenu');
            if (menu) {
                menu.classList.remove('show');
            }
            
            // Re-render artworks
            renderArtworks(displayedArtworks);
        }
    </script>
</body>
</html>

